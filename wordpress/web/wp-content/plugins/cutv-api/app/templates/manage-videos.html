<main>


    <div class="ui menu channel relative-wrapper" ng-if="!!videos">
        <div class="item">
            <div class="ui icon input">
                <input type="text" placeholder="Search...">
                <i class="search icon"></i>
            </div>
        </div>
        <div class="item">
            <select ng-model="selectedAction" ng-options="option.label for option in options">
            </select>
        </div>
        <div class="item" ng-if="selectedVideos">
            <button class="teal ui button" ng-click="updateVideos(selectedAction)">{{selectedAction.label }} <a
                    class="ui red circular tiny label">{{ selectedVideos.length }}</a></button>
        </div>

    </div>

    <div class="ui divided items">

        <article class="ui grid item" ng-repeat="source in sources | orderBy:'name':false">
            <div class="loading-overlay" ng-if="isLoading">
                <div class="active loader ui"></div>
            </div>
            <header class="eight wide column">
                <h3>{{source.name}}</h3>

                <div class="source-header">
                    <div class="ui list flex center" ng-if="videos[source.name].total">
                        <div class="left tiny multi-video-selector blue button ui">Multi-Select</div>
                        <div class="choices">

                            <div class="item" ng-repeat="option in options">
                                <div class="ui left labeled tiny button" ng-if="videos[source.name][option.state].length " ng-click="toggleSourceVideos(source, option.state)">
                                    <a class="ui {{option.color}}  left pointing label" ng-class="{'basic': !toggles[source.name][option.state] }">
                                        {{videos[source.name][option.state].length }}
                                    </a>
                                    <div class="ui button {{option.color}} tiny" ng-class="{'basic': !toggles[source.name][state]}">
                                        {{option.label}} Videos
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>


                </div>
            </header>
            <main class="eight wide column">

                <a class="ui violet basic button right icon" ng-click="openSourceDialog(source, 'run')">
                    <i class="refresh icon"></i> Run source
                </a>
                <a class="ui blue basic button right icon" href="/wp-admin/post.php?post={{source.source_id}}&action=edit" target="_blank">
                    <i class="youtube play icon"></i> Edit source
                </a>
            </main>
            <div class="content videos">

                <div>
                    <p ng-if="!videos[source.name].total && !isLoading">no videos</p>
                </div>

                <div class="ui link cards">
                    <div class="card video-{{video.ID}} {{video.selected ? 'selected' : ''}}" ng-repeat="video in videos[source.name].all | orderBy:'post_date':true | filter: query" ng-click="toggleVideoSelected(video)" ng-class="{'selected': isVideoSelected(video)}">

                        <div class="image">
                            <img ng-src="{{video.thumbnail}}">
                        </div>
                        <div class="content">
                            <div class="header">{{video.post_title}}</div>
                            <div class="meta">
                                <!-- <i class="right floated star icon" ng-click="$event.stopPropagation(); setFeatureVideo(channel.pid)"></i> -->
                                <div>
                                    <i class="ui icon calendar"></i> {{video.post_date}}
                                </div>
                            </div>

                            <div class="ui label {{video.post_status}}" ng-class="{'green': video.post_status === 'publish', 'grey' : video.post_status === 'draft', 'purple' : video.post_status === 'pending'}">
                                <i class="fa wpvr_video_status_icon fa-check-square "></i>{{video.post_status}}
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div class="modals" ng-include="'/wp-content/plugins/cutv-api/app/templates/source-modals.html'">
            </div>
        </article>

    </div>

</main>